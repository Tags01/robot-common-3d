<launch>
    <!--
        Pointcloud is published to the topic: tests/robot_common_3d/pcl_utilities/voxel_grid_filter/cloud_filtered

        Must launch camera with depth output enabled before this node and
        specify the ros arg `-\-ros-args point_cloud_topic:=<topic>`
        example:

        ```
        ros2 launch realsense2_camera rs_launch.py depth_module.depth_profile:=1280x720x30 pointcloud.enable:=true

        ros2 launch pcl_utilities test_voxel_grid_filter.xml point_cloud_topic:=/camera/camera/depth/color/points
        test_args="-/-wait_for_debugger" -/-launch-prefix="gnome-terminal -/- gdb -/-args"
        ```
    -->

    <arg name="point_cloud_topic" />
    <arg name="test_args" default=""/>
    <include file="$(find-pkg-share pcl_utilities)/launch/voxel_grid_filter.xml" />
    <node
        pkg="pcl_utilities"
        exec="unit_test"
        name="unit_test"
        args="$(var test_args) --"
        output="screen"
    >
        <param name="point_cloud_topic" value="$(var point_cloud_topic)" />
        <param name="node_client_name" value="/robot_common_3d/pcl_utilities/voxel_grid_filter" />
    </node>

    <node
        pkg="pcl_utilities"
        exec="simple_test_voxel_grid_filter"
        name="simple_test_voxel_grid_filter"
        namespace="/tests/robot_common_3d/pcl_utilities"
    >
        <param name="node_client_name" value="/robot_common_3d/pcl_utilities/voxel_grid_filter" />
        <param name="point_cloud_topic" value="$(var point_cloud_topic)" />
    </node>
</launch>